#include "MainScene.h"

MainScene::MainScene()
{
	Init();
}

MainScene::~MainScene()
{
	delete[] m_chArrTitleSprite;
	delete m_DoubleBuffering;
}

void MainScene::Init()
{
	m_strCommand = new char[30];
	sprintf_s(m_strCommand, 30, "mode con: cols=%d lines=%d", m_nWidth - 160, m_nHeight / 2);
	system(m_strCommand);

	m_DoubleBuffering = new DoubleBuffering(static_cast<int>(EColor_Type::SKYBLUE), m_nWidth - 160, m_nHeight / 2, 16);

	m_chArrTitleSprite = new char[]
	{
		15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15,
		15, 13, 13, 13, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 15, 15, 13, 13, 15,
		15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15,
		15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 13, 13, 13, 15, 15, 13, 13, 15, 15, 15, 15, 11, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 15, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 15, 15, 15, 13, 13, 13, 15,
		15, 15, 13, 13, 13, 15, 15, 15, 13, 13, 13, 15, 15, 11, 15, 13, 13, 13, 13, 13, 15, 15, 13, 13, 15, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 15, 15, 15, 15, 13, 13, 13, 15,
		11, 15, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11, 11, 15, 15, 15, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 11, 11, 15, 13, 13, 13, 13, 15, 13, 13, 13, 15, 11, 11, 11, 15, 13, 13, 15, 15, 15, 15, 15, 13, 13, 13, 13, 13, 13, 15,
		11, 15, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 11, 11, 15, 13, 13, 15, 15, 15, 15, 15, 15, 13, 13, 15, 11, 11, 11, 11, 15, 13, 13, 13, 15, 15, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 11,
		11, 11, 15, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 15, 15, 13, 13, 15, 13, 13, 15, 11, 11, 15, 13, 13, 15, 15, 15, 15, 15, 15, 13, 13, 15, 11, 11, 11, 11, 15, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11, 15, 13, 13, 13, 13, 13, 13, 13, 15, 15, 15, 13, 13, 13, 15, 11,
		11, 11, 15, 13, 13, 15, 15, 15, 13, 13, 13, 15, 15, 11, 15, 15, 15, 13, 13, 13, 15, 15, 13, 13, 15, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 15, 11, 15, 13, 13, 13, 13, 13, 13, 13, 15, 15, 15, 13, 13, 13, 15, 11,
		11, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 15, 15, 13, 13, 15, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 15, 11, 11, 11, 15, 13, 13, 13, 15, 15, 13, 13, 13, 15, 15, 15, 15, 15, 11, 15, 13, 13, 13, 15, 11,
		11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 15, 15, 15, 15, 15, 15, 13, 13, 15, 15, 15, 15, 15, 15, 11, 15, 13, 13, 13, 15, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11,
		11, 15, 13, 13, 13, 13, 13, 13, 13, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 15, 15, 15, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 15, 15, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11,
		11, 15, 13, 13, 13, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 15, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 15, 15, 15, 15, 13, 13, 13, 15, 15, 11, 15, 13, 13, 13, 15, 11,
		11, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 13, 13, 15, 11, 11, 11, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 15, 15, 15, 11, 15, 13, 13, 15, 15, 11,
		11, 11, 11, 11, 11, 15, 13, 13, 15, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 13, 13, 13, 15, 11, 11, 11, 11, 15, 13, 13, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11,
		11, 15, 15, 15, 15, 15, 13, 13, 15, 15, 15, 15, 15, 11, 11, 15, 15, 13, 13, 13, 15, 15, 15, 15, 13, 13, 15, 11, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11,
		11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 13, 13, 15, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11,
		11, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 15, 13, 13, 13, 15, 11, 11, 11, 11, 11, 15, 15, 13, 15, 11, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 11, 11, 11, 11, 11, 11, 11, 11, 15, 13, 13, 13, 15, 11, 11,
		11, 15, 15, 13, 13, 13, 15, 15, 15, 15, 15, 15, 15, 11, 11, 15, 13, 15, 11, 11, 11, 11, 11, 11, 11, 11, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 13, 15, 11, 11,
		11, 11, 15, 15, 15, 15, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 15, 15, 15, 11, 11
	};

	m_nArrowIndex = 0;
}

/// <summary>
/// MainScene 그리기
/// </summary>
void MainScene::Draw()
{
	m_DoubleBuffering->FillScreen(TITLE_START_X, TITLE_START_Y, m_chArrTitleSprite, 74, 20, false);
	m_DoubleBuffering->FillScreen(GAMESTART_TEXT_START_X, GAMESTART_TEXT_START_Y, "게임 시작", strlen("게임 시작"));
	m_DoubleBuffering->FillScreen(GAMEQUIT_TEXT_START_X, GAMEQUIT_TEXT_START_Y, "게임 종료", strlen("게임 종료"));

	if (m_nArrowIndex == 0)
	{
		m_DoubleBuffering->FillScreen(GAMESTART_TEXT_START_X - 4, GAMESTART_TEXT_START_Y, "▶", strlen("▶"));
		m_DoubleBuffering->FillScreen(GAMESTART_TEXT_START_X + 12, GAMESTART_TEXT_START_Y, "◀", strlen("◀"));
	}

	else
	{
		m_DoubleBuffering->FillScreen(GAMEQUIT_TEXT_START_X - 4, GAMEQUIT_TEXT_START_Y, "▶", strlen("▶"));
		m_DoubleBuffering->FillScreen(GAMEQUIT_TEXT_START_X + 12, GAMEQUIT_TEXT_START_Y, "◀", strlen("◀"));
	}

	m_DoubleBuffering->DrawScreen();
	m_DoubleBuffering->ClearScreen();
	m_DoubleBuffering->ChangeScreen();
}

/// <summary>
/// 화살표 위치 옮기기
/// </summary>
/// <param name="nPos"></param>
void MainScene::SetArrowPosition(int nPos)
{
	if (m_nArrowIndex + nPos < 0 || m_nArrowIndex + nPos > 1)
	{
		return;
	}

	else
	{
		m_nArrowIndex += nPos;
	}
}